# Lab2_2

Исследование факторов и организация работы с таблицами данных
Набор данных: data_purch.xlsx.

Статистика о государственных закупках лекарственных препаратов в 2021 году согласно Единой информационной системе в сфере закупок. Информация об одной процедуре может занимать более одной строки.
Если в рамках процедуры производилась закупка только одного лекарственного препарата, то такая процедура в таблице будет встречаться один раз и занимать одну строку. Если в одной процедуре содержалось n закупочных позиций, то информация об этой процедуре будет занимать в таблице n строк.

Загрузка данных
Часть фрейма

<img width="600" alt="image" src="https://user-images.githubusercontent.com/98012309/229871305-3343fe7d-44f3-48b0-973e-8446701ba160.png">

##### Описание данных
first_pub_date – дата публикации процедуры
final_protocol_pub_date – дата завершения процедуры
purchase_number – идентификатор процедуры
collecting_start_date – дата начала сбора заявок от потенциальных поставщиков
collecting_end_date – дата окончания сбора заявок от потенциальных поставщиков
placing_base_name – форма проведения торгов (конкурс, аукцион и т.п.)
cust_reg – регион заказчика процедуры
lot_price_correct – максимально возможная, объявленная заказчиком, цена за все препараты в закупке
drug_mnn_ext_code – идентификатор лекарственного препарата
drug_mnn_name – наименование лекарственного препарата (их меньше, чем drug_mnn_ext_code)
drug_qty – объем закупаемого лекарственного препарата
drug_price – цена за единицу объема закупаемого лекарственного препарата
drug_position_price – цена за всю позицию закупаемого лекарственного препарата
ftg – класс закупаемого лекарственного препарата
is_abnd – фиктивная переменная: 1 – закупка не состоялась, 0 – состоялась
is_znvlp – фиктивная переменная: 1 – в закупке содержится хотя бы 1 препарат из списка ЖВЛП, 0 – не содержатся
is_narcotic – фиктивная переменная: 1 – в закупке содержится хотя бы 1 препарат, в составе которого есть наркотические вещества, 0 – не содержатся
is_msp_purchase – фиктивная переменная: 1 – закупка предназначена только для субъектов малого и среднего предпринимательства, 0 – не предназначена
is_povt – фиктивная переменная: 1 – эту процедуру заказчик вынужден повторить, 0 – не повторная
is_dif – фиктивная переменная: 1 – в закупке содержится хотя бы 1 препарат, являющийся дефицитным, 0 – не содержатся
app_amount_absolute_correct – сумма залога
advance_sum_correct – сумма аванса

Я считаю, что наибольшее влияние на вероятность незакрытия закупки оказывают следующие факторы:

`placing_base_name` – форма проведения торгов (конкурс, аукцион и т.п.). Чем выше цена, тем меньше вероятность того, что найдется поставщик, готовый выполнить заказ по данной цене.

`drug_price` – цена за единицу объема закупаемого лекарственного препарата. Чем выше цена, тем меньше вероятность того, что найдется поставщик, готовый выполнить заказ по данной цене.

`is_abnd` - фиктивная переменная, которая указывает, состоялась ли закупка или нет. Если закупка не состоялась в прошлый раз, то это может повлиять на вероятность незакрытия закупки в будущем.

`is_povt` - фиктивная переменная, которая указывает, повторная ли это процедура. Если это повторная процедура, то это может указывать на то, что заказчик не смог найти поставщика в первый раз, что может повлиять на вероятность незакрытия закупки.

`advance_sum_correct` – сумма аванса. Чем выше сумма аванса, и тем меньше вероятность, что покупатель будет брать продукт.

Группировка

часть сгруппированного фрейма

<img width="386" alt="image" src="https://user-images.githubusercontent.com/98012309/229871760-2ec71184-4dc0-4875-86ed-46a7efb646d7.png">

Формирование факторов
Фактор, полученный с помощью метода главных компонент:
Фактор `outcome` - это фактор, полученный с помощью метода главных компонент из исходных столбцов с информацией о покупках. Этот фактор является линейной комбинацией исходных факторов, которые наилучшим образом объясняют вариацию в данных.

Факторы, полученные с помощью замен и арифметических операций:
Фактор `all_drug` - это фактор, который представляет количество препоратов в закупке. Вычисляется как отношение цены за всю позицию закупаемого лекарственного препарата к цена за единицу объема закупаемого лекарственного препарата.
Фактор `rem_lot_price_correct` - остаток путем вычетааванса от максимально возможной, объявленной заказчиком, цены за все препараты в закупке. Более высокая стоимость может сигнализировать о более высоком спросе на товар.

Разделяем на обучающую и тестовую выборки
при этом целевая переменная будет is_abnd

<img width="368" alt="image" src="https://user-images.githubusercontent.com/98012309/229872149-4d964703-112d-4b7d-aac4-f45db44a8736.png">

Оценка важности выделенных факторов на основе метода "Случайного леса"

<img width="593" alt="image" src="https://user-images.githubusercontent.com/98012309/229872244-a02d8619-c81c-4d53-bae9-84a367050622.png">

Построение модели логистической регрессии
Точность модели на обучающей выборке: 0.5048

Точность модели на тестовой выборке: 0.5023

Данные результаты говорят о том, что точность модели на тестовой выборке не сильно отличается от точности на обучающей выборке. Однако, точность модели на обеих выборках достаточно низкая (50.48% на обучающей выборке и 50.23% на тестовой выборке), что может указывать на то, что модель не обладает высокой способностью к обобщению на новые данные.
